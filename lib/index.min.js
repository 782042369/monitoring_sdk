!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).MonitorJS={})}(this,(function(e){"use strict";function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,r){return e(r={exports:{}},r.exports),r.exports}var n=r(t((function(e){e.exports=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}))),o=r(t((function(e){function r(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports}))),i=r(t((function(e){e.exports=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e},e.exports.__esModule=!0,e.exports.default=e.exports}))),a=t((function(e){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}));r(a);var c=r(t((function(e){e.exports=function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),r&&a(e,r)},e.exports.__esModule=!0,e.exports.default=e.exports}))),u=t((function(e){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}));r(u);var s,f,l,p=t((function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports})),d=r(p),h=r(t((function(e){var r=u.default;e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)},e.exports.__esModule=!0,e.exports.default=e.exports}))),v=t((function(e){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})),g=r(v);!function(e){e.JS_ERROR="js_error",e.RESOURCE_ERROR="resource_error",e.VUE_ERROR="vue_error",e.PROMISE_ERROR="promise_error",e.AJAX_ERROR="ajax_error",e.CROSS_SCRIPT_ERROR="cross_srcipt_error",e.UNKNOW_ERROR="unknow_error",e.PERFORMANCE="performance"}(s||(s={})),function(e){e.XHR="xhr",e.FETCH="fetch"}(f||(f={})),function(e){e.GET="get",e.POST="post",e.DELETE="delete",e.PUT="put"}(l||(l={}));var y,x={navigator:window.navigator,infoMap:{engine:["WebKit","Trident","Gecko","Presto"],browser:["Safari","Chrome","Edge","IE","Firefox","Firefox Focus","Chromium","Opera","Vivaldi","Yandex","Arora","Lunascape","QupZilla","Coc Coc","Kindle","Iceweasel","Konqueror","Iceape","SeaMonkey","Epiphany","360","360SE","360EE","UC","QQBrowser","QQ","Baidu","Maxthon","Sogou","LBBROWSER","2345Explorer","TheWorld","XiaoMi","Quark","Qiyu","Wechat","Taobao","Alipay","Weibo","Douban","Suning","iQiYi"],os:["Windows","Linux","Mac OS","Android","Ubuntu","FreeBSD","Debian","iOS","Windows Phone","BlackBerry","MeeGo","Symbian","Chrome OS","WebOS"],device:["Mobile","Tablet","iPad"]}},m={getMatchMap:function(e){return{Trident:e.indexOf("Trident")>-1||e.indexOf("NET CLR")>-1,Presto:e.indexOf("Presto")>-1,WebKit:e.indexOf("AppleWebKit")>-1,Gecko:e.indexOf("Gecko/")>-1,Safari:e.indexOf("Safari")>-1,Chrome:e.indexOf("Chrome")>-1||e.indexOf("CriOS")>-1,IE:e.indexOf("MSIE")>-1||e.indexOf("Trident")>-1,Edge:e.indexOf("Edge")>-1,Firefox:e.indexOf("Firefox")>-1||e.indexOf("FxiOS")>-1,"Firefox Focus":e.indexOf("Focus")>-1,Chromium:e.indexOf("Chromium")>-1,Opera:e.indexOf("Opera")>-1||e.indexOf("OPR")>-1,Vivaldi:e.indexOf("Vivaldi")>-1,Yandex:e.indexOf("YaBrowser")>-1,Arora:e.indexOf("Arora")>-1,Lunascape:e.indexOf("Lunascape")>-1,QupZilla:e.indexOf("QupZilla")>-1,"Coc Coc":e.indexOf("coc_coc_browser")>-1,Kindle:e.indexOf("Kindle")>-1||e.indexOf("Silk/")>-1,Iceweasel:e.indexOf("Iceweasel")>-1,Konqueror:e.indexOf("Konqueror")>-1,Iceape:e.indexOf("Iceape")>-1,SeaMonkey:e.indexOf("SeaMonkey")>-1,Epiphany:e.indexOf("Epiphany")>-1,360:e.indexOf("QihooBrowser")>-1||e.indexOf("QHBrowser")>-1,"360EE":e.indexOf("360EE")>-1,"360SE":e.indexOf("360SE")>-1,UC:e.indexOf("UC")>-1||e.indexOf(" UBrowser")>-1,QQBrowser:e.indexOf("QQBrowser")>-1,QQ:e.indexOf("QQ/")>-1,Baidu:e.indexOf("Baidu")>-1||e.indexOf("BIDUBrowser")>-1,Maxthon:e.indexOf("Maxthon")>-1,Sogou:e.indexOf("MetaSr")>-1||e.indexOf("Sogou")>-1,LBBROWSER:e.indexOf("LBBROWSER")>-1,"2345Explorer":e.indexOf("2345Explorer")>-1,TheWorld:e.indexOf("TheWorld")>-1,XiaoMi:e.indexOf("MiuiBrowser")>-1,Quark:e.indexOf("Quark")>-1,Qiyu:e.indexOf("Qiyu")>-1,Wechat:e.indexOf("MicroMessenger")>-1,Taobao:e.indexOf("AliApp(TB")>-1,Alipay:e.indexOf("AliApp(AP")>-1,Weibo:e.indexOf("Weibo")>-1,Douban:e.indexOf("com.douban.frodo")>-1,Suning:e.indexOf("SNEBUY-APP")>-1,iQiYi:e.indexOf("IqiyiApp")>-1,Windows:e.indexOf("Windows")>-1,Linux:e.indexOf("Linux")>-1||e.indexOf("X11")>-1,"Mac OS":e.indexOf("Macintosh")>-1,Android:e.indexOf("Android")>-1||e.indexOf("Adr")>-1,Ubuntu:e.indexOf("Ubuntu")>-1,FreeBSD:e.indexOf("FreeBSD")>-1,Debian:e.indexOf("Debian")>-1,"Windows Phone":e.indexOf("IEMobile")>-1||e.indexOf("Windows Phone")>-1,BlackBerry:e.indexOf("BlackBerry")>-1||e.indexOf("RIM")>-1,MeeGo:e.indexOf("MeeGo")>-1,Symbian:e.indexOf("Symbian")>-1,iOS:e.indexOf("like Mac OS X")>-1,"Chrome OS":e.indexOf("CrOS")>-1,WebOS:e.indexOf("hpwOS")>-1,Mobile:e.indexOf("Mobi")>-1||e.indexOf("iPh")>-1||e.indexOf("480")>-1,Tablet:e.indexOf("Tablet")>-1||e.indexOf("Nexus 7")>-1,iPad:e.indexOf("iPad")>-1}},matchInfoMap:function(e){var r=x.navigator.userAgent||{},t=m.getMatchMap(r);for(var n in x.infoMap)for(var o=0;o<x.infoMap[n].length;o++){var i=x.infoMap[n][o];t[i]&&(e[n]=i)}},getOS:function(){return m.matchInfoMap(this),this.os},getOSVersion:function(){var e=this,r=x.navigator.userAgent||{};e.osVersion="";var t={Windows:function(){var e=r.replace(/^.*Windows NT ([\d.]+);.*$/,"$1");return{6.4:"10",6.3:"8.1",6.2:"8",6.1:"7","6.0":"Vista",5.2:"XP",5.1:"XP","5.0":"2000"}[e]||e},Android:function(){return r.replace(/^.*Android ([\d.]+);.*$/,"$1")},iOS:function(){return r.replace(/^.*OS ([\d_]+) like.*$/,"$1").replace(/_/g,".")},Debian:function(){return r.replace(/^.*Debian\/([\d.]+).*$/,"$1")},"Windows Phone":function(){return r.replace(/^.*Windows Phone( OS)? ([\d.]+);.*$/,"$2")},"Mac OS":function(){return r.replace(/^.*Mac OS X ([\d_]+).*$/,"$1").replace(/_/g,".")},WebOS:function(){return r.replace(/^.*hpwOS\/([\d.]+);.*$/,"$1")}};return t[e.os]&&(e.osVersion=t[e.os](),e.osVersion===r&&(e.osVersion="")),e.osVersion},getOrientationStatu:function(){return window.matchMedia("(orientation: portrait)").matches?"竖屏":"横屏"},getDeviceType:function(){var e=this;return e.device="PC",m.matchInfoMap(e),e.device},getNetwork:function(){var e,r;return null===(e=navigator)||void 0===e||null===(r=e.connection)||void 0===r?void 0:r.effectiveType},getLanguage:function(){var e;return this.language=((e=(x.navigator.browserLanguage||x.navigator.language).split("-"))[1]&&(e[1]=e[1].toUpperCase()),e.join("_")),this.language},createFingerprint:function(e){var r=document.createElement("canvas"),t=r.getContext("2d"),n=e||window.location.host;t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(n,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(n,4,17);var o=r.toDataURL().replace("data:image/png;base64,","");return function(e){var r,t,n,o="";for(r=0,t=(e+="").length;r<t;r++)o+=(n=e.charCodeAt(r).toString(16)).length<2?"0".concat(n):n;return o}(atob(o).slice(-16,-12))},getBrowserInfo:function(){var e,r=this;m.matchInfoMap(r);var t,n,o=(null==x||null===(e=x.navigator)||void 0===e?void 0:e.userAgent)||{},i=function(e,r){var t=x.navigator.mimeTypes;for(var n in t)if(t[n][e]===r)return!0;return!1},a=m.getMatchMap(o),c=!1;if(window.chrome){var u=o.replace(/^.*Chrome\/([\d]+).*$/,"$1");u>36&&window.showModalDialog?c=!0:u>45&&(c=i("type","application/vnd.chromium.remoting-viewer"))}if(a.Baidu&&a.Opera&&(a.Baidu=!1),a.Mobile&&(a.Mobile=!(o.indexOf("iPad")>-1)),c&&(i("type","application/gameplugin")||null!=x&&null!==(t=x.navigator)&&void 0!==t&&null!==(n=t.connection)&&void 0!==n&&n.saveData?a["360SE"]=!0:a["360EE"]=!0),a.IE||a.Edge)switch(window.screenTop-window.screenY){case 71:case 74:case 99:case 75:case 74:case 105:break;case 102:a["360EE"]=!0;break;case 104:a["360SE"]=!0}var s={Safari:function(){return o.replace(/^.*Version\/([\d.]+).*$/,"$1")},Chrome:function(){return o.replace(/^.*Chrome\/([\d.]+).*$/,"$1").replace(/^.*CriOS\/([\d.]+).*$/,"$1")},IE:function(){return o.replace(/^.*MSIE ([\d.]+).*$/,"$1").replace(/^.*rv:([\d.]+).*$/,"$1")},Edge:function(){return o.replace(/^.*Edge\/([\d.]+).*$/,"$1")},Firefox:function(){return o.replace(/^.*Firefox\/([\d.]+).*$/,"$1").replace(/^.*FxiOS\/([\d.]+).*$/,"$1")},"Firefox Focus":function(){return o.replace(/^.*Focus\/([\d.]+).*$/,"$1")},Chromium:function(){return o.replace(/^.*Chromium\/([\d.]+).*$/,"$1")},Opera:function(){return o.replace(/^.*Opera\/([\d.]+).*$/,"$1").replace(/^.*OPR\/([\d.]+).*$/,"$1")},Vivaldi:function(){return o.replace(/^.*Vivaldi\/([\d.]+).*$/,"$1")},Yandex:function(){return o.replace(/^.*YaBrowser\/([\d.]+).*$/,"$1")},Arora:function(){return o.replace(/^.*Arora\/([\d.]+).*$/,"$1")},Lunascape:function(){return o.replace(/^.*Lunascape[\/\s]([\d.]+).*$/,"$1")},QupZilla:function(){return o.replace(/^.*QupZilla[\/\s]([\d.]+).*$/,"$1")},"Coc Coc":function(){return o.replace(/^.*coc_coc_browser\/([\d.]+).*$/,"$1")},Kindle:function(){return o.replace(/^.*Version\/([\d.]+).*$/,"$1")},Iceweasel:function(){return o.replace(/^.*Iceweasel\/([\d.]+).*$/,"$1")},Konqueror:function(){return o.replace(/^.*Konqueror\/([\d.]+).*$/,"$1")},Iceape:function(){return o.replace(/^.*Iceape\/([\d.]+).*$/,"$1")},SeaMonkey:function(){return o.replace(/^.*SeaMonkey\/([\d.]+).*$/,"$1")},Epiphany:function(){return o.replace(/^.*Epiphany\/([\d.]+).*$/,"$1")},360:function(){return o.replace(/^.*QihooBrowser\/([\d.]+).*$/,"$1")},"360SE":function(){return{63:"10.0",55:"9.1",45:"8.1",42:"8.0",31:"7.0",21:"6.3"}[o.replace(/^.*Chrome\/([\d]+).*$/,"$1")]||""},"360EE":function(){return{69:"11.0",63:"9.5",55:"9.0",50:"8.7",30:"7.5"}[o.replace(/^.*Chrome\/([\d]+).*$/,"$1")]||""},Maxthon:function(){return o.replace(/^.*Maxthon\/([\d.]+).*$/,"$1")},QQBrowser:function(){return o.replace(/^.*QQBrowser\/([\d.]+).*$/,"$1")},QQ:function(){return o.replace(/^.*QQ\/([\d.]+).*$/,"$1")},Baidu:function(){return o.replace(/^.*BIDUBrowser[\s\/]([\d.]+).*$/,"$1")},UC:function(){return o.replace(/^.*UC?Browser\/([\d.]+).*$/,"$1")},Sogou:function(){return o.replace(/^.*SE ([\d.X]+).*$/,"$1").replace(/^.*SogouMobileBrowser\/([\d.]+).*$/,"$1")},LBBROWSER:function(){return{57:"6.5",49:"6.0",46:"5.9",42:"5.3",39:"5.2",34:"5.0",29:"4.5",21:"4.0"}[navigator.userAgent.replace(/^.*Chrome\/([\d]+).*$/,"$1")]||""},"2345Explorer":function(){return o.replace(/^.*2345Explorer\/([\d.]+).*$/,"$1")},TheWorld:function(){return o.replace(/^.*TheWorld ([\d.]+).*$/,"$1")},XiaoMi:function(){return o.replace(/^.*MiuiBrowser\/([\d.]+).*$/,"$1")},Quark:function(){return o.replace(/^.*Quark\/([\d.]+).*$/,"$1")},Qiyu:function(){return o.replace(/^.*Qiyu\/([\d.]+).*$/,"$1")},Wechat:function(){return o.replace(/^.*MicroMessenger\/([\d.]+).*$/,"$1")},Taobao:function(){return o.replace(/^.*AliApp\(TB\/([\d.]+).*$/,"$1")},Alipay:function(){return o.replace(/^.*AliApp\(AP\/([\d.]+).*$/,"$1")},Weibo:function(){return o.replace(/^.*weibo__([\d.]+).*$/,"$1")},Douban:function(){return o.replace(/^.*com.douban.frodo\/([\d.]+).*$/,"$1")},Suning:function(){return o.replace(/^.*SNEBUY-APP([\d.]+).*$/,"$1")},iQiYi:function(){return o.replace(/^.*IqiyiVersion\/([\d.]+).*$/,"$1")}};return r.browserVersion="",s[r.browser]&&(r.browserVersion=s[r.browser](),r.browserVersion===o&&(r.browserVersion="")),"Edge"===r.browser&&(r.engine="EdgeHTML"),"Chrome"===r.browser&&parseInt(r.browserVersion)>27&&(r.engine="Blink"),"Opera"===r.browser&&parseInt(r.browserVersion)>12&&(r.engine="Blink"),"Yandex"===r.browser&&(r.engine="Blink"),{type:r.browser,version:r.browserVersion,engine:r.engine}}},O=(y={DeviceInfoObj:function(e){e=e||{domain:""};var r={type:m.getDeviceType(),os:m.getOS(),osv:m.getOSVersion(),h:window.screen.height,w:window.screen.width,lan:m.getLanguage(),net:m.getNetwork(),orientation:m.getOrientationStatu(),browser:m.getBrowserInfo(),fingerprint:m.createFingerprint(e.domain)};if(!e.info||0===e.info.length)return r;var t={},n=function(n){e.info.forEach((function(e){e.toLowerCase()===n.toLowerCase()&&(t[e=n]=r[e])}))};for(var o in r)n(o);return t}},{getDeviceInfo:function(e){return y.DeviceInfoObj(e)}}),E=t((function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports}));r(E);var w=t((function(e){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports}));r(w);var b=t((function(e){function r(t,n,o){return w()?(e.exports=r=Reflect.construct,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(e,r,t){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(e,n));return t&&a(o,t.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(null,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}));r(b);var S=t((function(e){function r(t){var n="function"==typeof Map?new Map:void 0;return e.exports=r=function(e){if(null===e||!E(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return b(e,arguments,v(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,e)},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}));function R(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}function $(e){if(!e)return!1;return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/.test(e)}function M(e){return Object.prototype.toString.call(e).replace(/\[object\s|\]/g,"")}function _(e){return"Function"===M(e)}var T=function(e){c(t,e);var r=R(t);function t(){return n(this,t),r.call(this)}return o(t,[{key:"format",value:function(e){var r={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var t in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(String(this.getFullYear())).substr(4-RegExp.$1.length))),/(E+)/.test(e)&&(e=e.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}["".concat(String(this.getDay()))])),r)new RegExp("(".concat(t,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?r[t]:"00".concat(r[t]).substr("".concat(String(r[t])).length)));return e}}]),t}(r(S)(Date));function I(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz123456789",t=r.length,n="",o=0;o<e;o++)n+=r.charAt(Math.floor(Math.random()*t));return n+(new Date).getTime()}function P(e){if(e)return String(e);var r=localStorage.getItem("ps_markUser")||"";return r||(r=I(),localStorage.setItem("ps_markUser",r)),r}function k(){var e=new T,r=localStorage.getItem("ps_markUv")||"",t=localStorage.getItem("ps_markUvTime")||"",n=e.format("yyyy/MM/dd 23:59:59");return(!r&&!t||e.getTime()>1*t)&&(r=I(),localStorage.setItem("ps_markUv",r),localStorage.setItem("ps_markUvTime",JSON.stringify(new Date(n).getTime()))),r}var j,D=function(){function e(r){n(this,e),i(this,"reportUrl",void 0),this.reportUrl=r}return o(e,[{key:"report",value:function(e){if(!$(this.reportUrl))throw"上报信息url地址格式不正确,reportUrl=".concat(this.reportUrl);this.reportByImg(e)}},{key:"sendInfo",value:function(e){var r=JSON.stringify(e);try{if(fetch)return void fetch(this.reportUrl,{headers:{"Content-Type":"application/json"},method:"POST",body:r,mode:"same-origin",keepalive:!0})}catch(e){}try{var t=new XMLHttpRequest;t.open("POST",this.reportUrl,!0),t.setRequestHeader("Content-Type","application/json"),t.send(r)}catch(e){}}},{key:"reportByImg",value:function(e){if(!$(this.reportUrl))throw"上报信息url地址格式不正确,reportUrl=".concat(this.reportUrl);try{(new Image).src="".concat(this.reportUrl,"/up.gif?v=").concat((new Date).getTime(),"&").concat(this.formatParams(e))}catch(e){}}},{key:"formatParams",value:function(e){var r=[];for(var t in e)r.push("".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t])));return r.join("&")}}]),e}(),B={isStop:!0,queues:[],add:function(e,r){this.queues.push({reportUrl:e,data:r})},fire:function(){if(this.queues&&0!==this.queues.length){this.isStop=!1;var e=this.queues[0];new D(e.reportUrl).report(e.data),this.queues.splice(0,1),this.fire()}else this.isStop=!0}};function U(e){return e.reverse().filter((function(e){return e!==document&&e!==window})).map((function(e){return e.id?"".concat(e.nodeName.toLowerCase(),"#").concat(e.id):e.className&&"string"==typeof e.className?"".concat(e.nodeName.toLowerCase(),".").concat(e.className):e.nodeName.toLowerCase()})).join(" ")}function C(e){if("Array"===M(e))return U(e);for(var r=[];e;)r.push(e),e=e.parentNode;return U(r)}function L(){return j}function F(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function A(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?F(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}["click","touchstart","mousedown","keydown","mouseover"].forEach((function(e){document.addEventListener(e,(function(e){j=e}),{capture:!0,passive:!0})}));var Q=function(){function e(r){n(this,e),i(this,"category",void 0),i(this,"msg",void 0),i(this,"url",void 0),i(this,"line",void 0),i(this,"col",void 0),i(this,"errorObj",void 0),i(this,"reportUrl",void 0),i(this,"extendsInfo",void 0),i(this,"appID",void 0),i(this,"userID",void 0),this.category=s.UNKNOW_ERROR,this.msg="",this.url="",this.line="",this.col="",this.errorObj={},this.reportUrl=r.reportUrl,this.extendsInfo=r.extendsInfo,this.appID=r.appID,void 0!==r.userID&&(this.userID=r.userID)}return o(e,[{key:"recordError",value:function(){this.handleRecordError(),setTimeout((function(){B.isStop&&B.fire()}),100)}},{key:"handleRecordError",value:function(){try{if(!this.msg)return;if(this.reportUrl&&this.url&&this.url.toLowerCase().indexOf(this.reportUrl.toLowerCase())>=0)return;var e=this.handleErrorInfo();B.add(this.reportUrl,e)}catch(e){}}},{key:"handleErrorInfo",value:function(){var e,r={loginformation:this.msg};if(null!=this&&null!==(e=this.errorObj)&&void 0!==e&&e.stack&&(r.errorstack=this.errorObj.stack),this.category===s.JS_ERROR)r.errorline=this.line,r.errorcol=this.col;else r.errorother=this.errorObj;var t=L(),n=t?C(t.path):"",o=this.getDeviceInfo(),i=A(A({},this.getExtendsInfo()),{},{category:this.category,device:o,appID:this.appID,url:(null==this?void 0:this.url)||location.href,log:JSON.stringify(r),markUser:P(this.userID),markUv:k(),preUrl:document.referrer});return n&&(i.selector=n),i}},{key:"getExtendsInfo",value:function(){try{var e,r={},t=this.extendsInfo||{};for(var n in _(t.getDynamic)&&(e=t.getDynamic()),"Object"===M(e)&&(t=A(A({},t),e)),t)_(t[n])||(r[n]=t[n]);return r}catch(e){return{}}}},{key:"getDeviceInfo",value:function(){try{var e=O.getDeviceInfo();return JSON.stringify(e)}catch(e){return""}}}]),e}();function W(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}var N=function(){function e(r){n(this,e),i(this,"params",void 0),this.params=r}return o(e,[{key:"handleError",value:function(){new V(this.params)}}]),e}(),V=function(e){c(t,e);var r=W(t);function t(e){var o;return n(this,t),o=r.call(this,e),window.XMLHttpRequest&&o.handleXhrError(),window.fetch&&o.handleFetchError(),o}return o(t,[{key:"_handleEvent",value:function(e,r,t,n,o){try{var i=Date.now()-r;this.category=s.AJAX_ERROR,this.msg=s.AJAX_ERROR,this.errorObj={status:t.status,duration:i,type:e,method:o.method.toLowerCase(),lib:n,path:o.url},this.recordError()}catch(e){}}},{key:"handleXhrError",value:function(){var e=this,r=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(e,t){return t.match(/up.gif/)||t.match(/sockjs/)||(this.logData={method:e||l.GET,url:t}),r.apply(this,arguments)};var t=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){var r=this;if(this.addEventListener&&this.logData){var n=Date.now();["error","load","abort"].map((function(t){r.addEventListener(t,(function(){e._handleEvent(t,n,r,f.XHR,r.logData)}))}))}return t.apply(this,arguments)}}},{key:"handleFetchError",value:function(){var e=this,r=window.fetch;window.fetch=function(){for(var t,n={method:l.GET,url:""},o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];n.method=(null==i||null===(t=i[1])||void 0===t?void 0:t.method)||l.GET,n.url=i[0];var c=Date.now();r.apply(this,i).then((function(r){var t=r.clone();e._handleEvent(r.ok?"load":"error",c,{status:t.status||r.ok?200:500,response:r},f.FETCH,n)})).catch((function(r){throw e._handleEvent("error",c,{status:500,response:r},f.FETCH,n),r}))}}}]),t}(Q);function q(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}var H=function(e){c(t,e);var r=q(t);function t(e){return n(this,t),r.call(this,e)}return o(t,[{key:"handleError",value:function(){var e=this;window.onerror=function(r,t,n,o,i){try{e.category=s.JS_ERROR,e.msg=r,e.url=t,e.line=n,e.col=o,e.errorObj=i,e.recordError()}catch(i){}}}}]),t}(Q);function X(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}var J=function(e){c(t,e);var r=X(t);function t(e){return n(this,t),r.call(this,e)}return o(t,[{key:"handleError",value:function(){var e=this;window.addEventListener("unhandledrejection",(function(r){try{var t,n;if(!r||!r.reason)return;null!=r&&null!==(t=r.reason)&&void 0!==t&&null!==(n=t.config)&&void 0!==n&&n.url&&(e.url=r.reason.config.url),e.category=s.PROMISE_ERROR,e.msg=r.reason,e.errorObj=r.reason,e.recordError()}catch(e){}}),!0)}}]),t}(Q);function K(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Y(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?K(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function G(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}var Z=function(e){c(t,e);var r=G(t);function t(e){return n(this,t),r.call(this,e)}return o(t,[{key:"handleError",value:function(){var e=this;window.addEventListener("error",(function(r){try{if(!r)return;e.category=s.RESOURCE_ERROR;var t=r.target||r.srcElement;if(!(t instanceof HTMLScriptElement||t instanceof HTMLLinkElement||t instanceof HTMLImageElement))return;e.msg="加载 ".concat(t.tagName," 资源错误"),e.url=location.href,e.errorObj=Y(Y({},t),{},{src:t.src||t.href}),e.recordError()}catch(e){}}),!0)}}]),t}(Q);function z(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}function ee(e,r,t,n){var o=null==n?void 0:n.version,i={message:"".concat(e.message,"(").concat(t,")"),url:"undefined"==typeof document||null===document.location?"":document.location.href,name:e.name,stack:e.stack||[]};if("String"===M(o))switch(function(e){return Number(e.split(".")[0])}(o)){case 2:i=Object.assign(i,function(e){var r="";if(e.$root===e)r="root";else{var t=e._isVue?e.$options&&e.$options.name||e.$options&&e.$options._componentTag:e.name;r=(t?"component <".concat(t,">"):"anonymous component")+(e._isVue&&e.$options&&e.$options.__file?" at ".concat(e.$options&&e.$options.__file):"")}return{componentName:r,propsData:e.$options&&e.$options.propsData}}(r));break;case 3:i=Object.assign(i,function(e){var r="";if(e.$root===e)r="root";else{var t=e.$options&&e.$options.name;r=t?"component <".concat(t,">"):"anonymous component"}return{componentName:r,propsData:e.$props}}(r));break;default:return}return i}var re=function(e){c(t,e);var r=z(t);function t(e){return n(this,t),r.call(this,e)}return o(t,[{key:"handleError",value:function(e){var r=this;e&&(e.config.errorHandler=function(t,n,o){try{r.msg=JSON.stringify(ee(t,n,o,e)),r.category=s.VUE_ERROR,r.recordError()}catch(t){}})}}]),t}(Q),te={getTiming:function(){try{if(!window.performance||!window.performance.timing)return;var e=window.performance.timing,r={};return e.loadEventEnd-e.loadEventStart<0?void setTimeout((function(){te.getTiming()}),200):(r.redirectTime=(e.redirectEnd-e.redirectStart).toFixed(2),r.dnsTime=(e.domainLookupEnd-e.domainLookupStart).toFixed(2),r.ttfbTime=(e.responseStart-e.navigationStart).toFixed(2),r.appcacheTime=(e.domainLookupStart-e.fetchStart).toFixed(2),r.unloadTime=(e.unloadEventEnd-e.unloadEventStart).toFixed(2),r.tcpTime=(e.connectEnd-e.connectStart).toFixed(2),r.reqTime=(e.responseEnd-e.responseStart).toFixed(2),r.analysisTime=(e.domComplete-e.domInteractive).toFixed(2),r.blankTime=(e.domLoading-e.navigationStart).toFixed(2),r.domReadyTime=(e.domContentLoadedEventEnd-e.navigationStart).toFixed(2),r.loadPageTime=(e.loadEventEnd-e.navigationStart).toFixed(2),r)}catch(e){}},getEntries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(window.performance&&window.performance.getEntries){var r=[],t=window.performance.getEntries();return t&&0!==t.length?(t.forEach((function(t){var n={};e.indexOf(t.initiatorType)>-1&&(n.name=t.name,n.initiatorType=t.initiatorType,n.nextHopProtocol=t.nextHopProtocol,n.redirectTime=(t.redirectEnd-t.redirectStart).toFixed(2),n.dnsTime=(t.domainLookupEnd-t.domainLookupStart).toFixed(2),n.tcpTime=(t.connectEnd-t.connectStart).toFixed(2),n.ttfbTime=(t.responseStart-t.requestStart).toFixed(2),n.responseTime=(t.responseEnd-t.responseStart).toFixed(2),n.reqTotalTime=(t.responseEnd-t.requestStart).toFixed(2),r.push(n))})),r):r}}};function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function oe(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){i(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ie(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=g(e);if(r){var o=g(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h(this,t)}}var ae=function(e){c(t,e);var r=ie(t);function t(e){var o;return n(this,t),o=r.call(this,{reportUrl:e.reportUrl,appID:e.appID,extendsInfo:e.extendsInfo}),i(d(o),"isPage",void 0),i(d(o),"isResource",void 0),i(d(o),"usefulType",void 0),i(d(o),"outTime",void 0),i(d(o),"config",void 0),e.isPage=!1!==e.isPage,e.isResource=!1!==e.isResource,o.isPage=e.isPage,o.isResource=e.isResource,o.usefulType=o.getSourceType(e),o.outTime=50,o.config={resourceList:[],performance:{}},o.category=s.PERFORMANCE,o.reportUrl=e.reportUrl||"",o}return o(t,[{key:"getSourceType",value:function(e){var r=[];return!1!==e.isRScript&&r.push("script"),!1!==e.isRCSS&&r.push("css"),!1!==e.isRFetch&&r.push("fetch"),!1!==e.isRXHR&&r.push("xmlhttprequest"),!1!==e.isRLink&&r.push("link"),!1!==e.isRIMG&&r.push("img"),r}},{key:"record",value:function(){try{this.isPage&&(this.config.performance=te.getTiming()),this.isResource&&(this.config.resourceList=te.getEntries(this.usefulType));var e={performance:this.config.performance,resourceList:this.config.resourceList},r=oe(oe({},this.getExtendsInfo()),{},{category:this.category,log:JSON.stringify(e),device:this.getDeviceInfo(),appID:this.appID,markUser:P(this.userID),markUv:k(),url:(null==this?void 0:this.url)||location.href});localStorage.setItem("page_performance",JSON.stringify(r)),new D(this.reportUrl).report(r),this.clearPerformance()}catch(e){}}},{key:"clearPerformance",value:function(){var e,r;null!==(e=window)&&void 0!==e&&null!==(r=e.performance)&&void 0!==r&&r.clearResourceTimings&&(performance.clearResourceTimings(),this.config.performance={},this.config.resourceList="")}}]),t}(Q),ce=function(){function e(){n(this,e),i(this,"jsError",void 0),i(this,"promiseError",void 0),i(this,"resourceError",void 0),i(this,"ajaxError",void 0),i(this,"vueError",void 0),this.jsError=!0,this.promiseError=!0,this.resourceError=!0,this.ajaxError=!0,this.vueError=!1}return o(e,[{key:"init",value:function(e){if(null==e||!e.reportUrl||!$(e.reportUrl))throw"reportUrl is error,".concat(e.reportUrl);if(null==e||!e.appID)throw"appID is error,".concat(e.appID);this.jsError=!(!1===(null==e?void 0:e.jsError)),this.promiseError=!(!1===(null==e?void 0:e.promiseError)),this.resourceError=!(!1===(null==e?void 0:e.resourceError)),this.ajaxError=!(!1===(null==e?void 0:e.ajaxError)),this.vueError=!0===(null==e?void 0:e.vueError);var r=e.reportUrl,t=e.appID,n={reportUrl:r,extendsInfo:e.extendsInfo||{},appID:t,userID:e.userID};this.jsError&&new H(n).handleError(),this.promiseError&&new J(n).handleError(),this.resourceError&&new Z(n).handleError(),this.ajaxError&&new N(n).handleError(),this.vueError&&e.vue&&new re(n).handleError(e.vue),this.monitorPerformance(e)}},{key:"monitorPerformance",value:function(e){var r=function(){new ae(e).record()};r(),window.removeEventListener("unload",r),window.addEventListener("unload",r)}}]),e}();window.MonitorJS=ce,e.MonitorJS=ce,Object.defineProperty(e,"__esModule",{value:!0})}));
