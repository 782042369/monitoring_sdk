!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).MonitorJS={})}(this,(function(t){"use strict";function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function r(t,e){return t(e={exports:{}},e.exports),e.exports}var o=e(r((function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports}))),n=e(r((function(t){function e(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.exports=function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports}))),i=e(r((function(t){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t},t.exports.__esModule=!0,t.exports.default=t.exports}))),c=r((function(t){function e(t,e,r,o,n,i,c){try{var a=t[i](c),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(o,n)}t.exports=function(t){return function(){var r=this,o=arguments;return new Promise((function(n,i){var c=t.apply(r,o);function a(t){e(c,n,i,a,u,"next",t)}function u(t){e(c,n,i,a,u,"throw",t)}a(void 0)}))}},t.exports.__esModule=!0,t.exports.default=t.exports})),a=e(c),u=r((function(t){function e(r,o){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r,o)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(u);var s=e(r((function(t){t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&u(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports}))),f=r((function(t){function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(f);var l,p,h,d,v=r((function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports})),y=e(v),g=e(r((function(t){var e=f.default;t.exports=function(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return v(t)},t.exports.__esModule=!0,t.exports.default=t.exports}))),m=r((function(t){function e(r){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})),w=e(m),x=r((function(t){var e=function(t){var e,r=Object.prototype,o=r.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",c=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var n=e&&e.prototype instanceof y?e:y,i=Object.create(n.prototype),c=new P(o||[]);return i._invoke=function(t,e,r){var o=l;return function(n,i){if(o===h)throw new Error("Generator is already running");if(o===d){if("throw"===n)throw i;return I()}for(r.method=n,r.arg=i;;){var c=r.delegate;if(c){var a=R(c,r);if(a){if(a===v)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===l)throw o=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var u=f(t,e,r);if("normal"===u.type){if(o=r.done?d:p,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=d,r.method="throw",r.arg=u.arg)}}}(t,r,c),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var l="suspendedStart",p="suspendedYield",h="executing",d="completed",v={};function y(){}function g(){}function m(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(T([])));E&&E!==r&&o.call(E,i)&&(w=E);var b=m.prototype=y.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(n,i,c,a){var u=f(t[n],t,i);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,c,a)}),(function(t){r("throw",t,c,a)})):e.resolve(l).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,a)}))}a(u.arg)}var n;this._invoke=function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}}function R(t,r){var o=t.iterator[r.method];if(o===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,R(t,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=f(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,v;var i=n.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,c=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return c.next=c}}return{next:I}}function I(){return{value:e,done:!0}}return g.prototype=m,u(b,"constructor",m),u(m,"constructor",g),g.displayName=u(m,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,a,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},O(S.prototype),u(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,r,o,n,i){void 0===i&&(i=Promise);var c=new S(s(e,r,o,n),i);return t.isGeneratorFunction(r)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},O(b),u(b,a,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var o=e.pop();if(o in t)return r.value=o,r.done=!1,r}return r.done=!0,r}},t.values=T,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(_),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(o,n){return a.type="throw",a.arg=t,r.next=o,n&&(r.method="next",r.arg=e),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],a=c.completion;if("root"===c.tryLoc)return n("end");if(c.tryLoc<=this.prev){var u=o.call(c,"catchLoc"),s=o.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return n(c.catchLoc,!0);if(this.prev<c.finallyLoc)return n(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return n(c.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return n(c.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var o=r.completion;if("throw"===o.type){var n=o.arg;_(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,o){return this.delegate={iterator:T(t),resultName:r,nextLoc:o},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})),E=x;!function(t){t.JS="js",t.RESOURCE="resource",t.VUE="vue",t.PROMISE="promise",t.AJAX="ajax",t.CROSS_SCRIPT="cross_srcipt",t.UNKNOW="unknow",t.PERFORMANCE="performance"}(l||(l={})),function(t){t.XHR="xhr",t.FETCH="fetch"}(p||(p={})),function(t){t.GET="get",t.POST="post",t.DELETE="delete",t.PUT="put"}(h||(h={})),function(t){t.FIRST_PV="ps_first",t.MARKUSER="ps_markUser",t.MARKTIME="ps_markUvTime",t.MARKUV="ps_markUv"}(d||(d={}));var b=r((function(t){t.exports=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},t.exports.__esModule=!0,t.exports.default=t.exports}));e(b);var O=r((function(t){t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports}));e(O);var S=r((function(t){function e(r,o,n){return O()?(t.exports=e=Reflect.construct,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=e=function(t,e,r){var o=[null];o.push.apply(o,e);var n=new(Function.bind.apply(t,o));return r&&u(n,r.prototype),n},t.exports.__esModule=!0,t.exports.default=t.exports),e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));e(S);var R=r((function(t){function e(r){var o="function"==typeof Map?new Map:void 0;return t.exports=e=function(t){if(null===t||!b(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(t))return o.get(t);o.set(t,e)}function e(){return S(t,arguments,m(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),u(e,t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}));function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}function _(t){if(!t)return!1;return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/.test(t)}function P(t){return Object.prototype.toString.call(t).replace(/\[object\s|\]/g,"")}function T(t){return"Function"===P(t)}var I=function(t){s(r,t);var e=j(r);function r(){return o(this,r),e.call(this)}return n(r,[{key:"format",value:function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,"".concat(String(this.getFullYear())).substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+{0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"}["".concat(String(this.getDay()))])),e)new RegExp("(".concat(r,")")).test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[r]:"00".concat(e[r]).substr("".concat(String(e[r])).length)));return t}}]),r}(e(R)(Date));function k(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz123456789",r=e.length,o="",n=0;n<t;n++)o+=e.charAt(Math.floor(Math.random()*r));return o+(new Date).getTime()}function L(t){if(t)return String(t);var e=localStorage.getItem(d.MARKUSER)||"";return e||(e=k(),localStorage.setItem(d.MARKUSER,e)),e}function M(){var t=new I,e=localStorage.getItem(d.MARKUV)||"",r=localStorage.getItem(d.MARKTIME)||"",o=t.format("yyyy/MM/dd 23:59:59");return(!e&&!r||t.getTime()>1*r)&&(e=k(),localStorage.setItem(d.MARKUV,e),localStorage.setItem(d.MARKTIME,JSON.stringify(new Date(o).getTime()))),e}function D(){var t=document.createElement("canvas"),e=t.getContext("2d"),r=window.location.host;e.textBaseline="top",e.font="14px 'Arial'",e.textBaseline="alphabetic",e.fillStyle="#f60",e.fillRect(125,1,62,20),e.fillStyle="#069",e.fillText(r,2,15),e.fillStyle="rgba(102, 204, 0, 0.7)",e.fillText(r,4,17);var o=t.toDataURL().replace("data:image/png;base64,","");return function(t){var e,r,o,n="";for(e=0,r=(t+="").length;e<r;e++)n+=(o=t.charCodeAt(e).toString(16)).length<2?"0".concat(o):o;return n}(atob(o).slice(-16,-12))}function U(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function F(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?U(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var N,B=function(){function t(e){o(this,t),i(this,"reportUrl",void 0),this.reportUrl=e}return n(t,[{key:"report",value:function(t){if(!_(this.reportUrl))throw"上报信息url地址格式不正确,reportUrl=".concat(this.reportUrl);var e,r,o,n=F(F({},t),{},{first:sessionStorage.getItem(d.FIRST_PV)?0:(sessionStorage.setItem(d.FIRST_PV,"1"),1),device:JSON.stringify({lan:(o=window.navigator.language.split("-"),o[1]&&(o[1]=o[1].toUpperCase()),o.join("_")),net:null===(e=navigator)||void 0===e||null===(r=e.connection)||void 0===r?void 0:r.effectiveType,orientation:window.matchMedia("(orientation: portrait)").matches?"竖屏":"横屏",fingerprint:D(),h:window.screen.height,w:window.screen.width})});"sendBeacon"in navigator?this.reportByNavigator(n):this.reportByImg(n)}},{key:"reportByImg",value:function(t){if(!_(this.reportUrl))throw"上报信息url地址格式不正确,reportUrl=".concat(this.reportUrl);try{(new Image).src="".concat(this.reportUrl,"/up.gif?v=").concat((new Date).getTime(),"&").concat(this.formatParams(t))}catch(t){}}},{key:"reportByNavigator",value:function(t){navigator.sendBeacon(this.reportUrl,JSON.stringify(t))}},{key:"formatParams",value:function(t){var e=[];for(var r in t)e.push("".concat(encodeURIComponent(r),"=").concat(encodeURIComponent(t[r])));return e.join("&")}}]),t}(),A={isStop:!0,queues:[],add:function(t,e){this.queues.push({reportUrl:t,data:e})},fire:function(){if(this.queues&&0!==this.queues.length){this.isStop=!1;var t=this.queues[0];new B(t.reportUrl).report(t.data),this.queues.splice(0,1),this.fire()}else this.isStop=!0}};function C(t){return t.reverse().filter((function(t){return t!==document&&t!==window})).map((function(t){return t.id?"".concat(t.nodeName.toLowerCase(),"#").concat(t.id):t.className&&"string"==typeof t.className?"".concat(t.nodeName.toLowerCase(),".").concat(t.className):t.nodeName.toLowerCase()})).join(" ")}function $(t){if("Array"===P(t))return C(t);for(var e=[];t;)e.push(t),t=t.parentNode;return C(e)}function H(){return N}function J(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}["click","touchstart","mousedown","keydown","mouseover"].forEach((function(t){document.addEventListener(t,(function(t){N=t}),{capture:!0,passive:!0})}));var G=function(){function t(e){o(this,t),i(this,"category",void 0),i(this,"msg",void 0),i(this,"url",void 0),i(this,"line",void 0),i(this,"col",void 0),i(this,"errorObj",void 0),i(this,"reportUrl",void 0),i(this,"extendsInfo",void 0),i(this,"appID",void 0),i(this,"userID",void 0),this.category=l.UNKNOW,this.msg="",this.url="",this.line="",this.col="",this.errorObj={},this.reportUrl=e.reportUrl,this.extendsInfo=e.extendsInfo,this.appID=e.appID,void 0!==e.userID&&(this.userID=e.userID)}return n(t,[{key:"recordError",value:function(){this.handleRecordError(),setTimeout((function(){A.isStop&&A.fire()}),100)}},{key:"handleRecordError",value:function(){try{if(!this.msg)return;if(this.reportUrl&&this.url&&this.url.toLowerCase().indexOf(this.reportUrl.toLowerCase())>=0)return;var t=this.handleErrorInfo();A.add(this.reportUrl,t)}catch(t){}}},{key:"handleErrorInfo",value:function(){var t,e={loginformation:this.msg};if(null!=this&&null!==(t=this.errorObj)&&void 0!==t&&t.stack&&(e.errorstack=this.errorObj.stack),this.category===l.JS)e.errorline=this.line,e.errorcol=this.col;else e.logother=this.errorObj;var r=H(),o=r?$(r.path):"",n=q(q({},this.getExtendsInfo()),{},{category:this.category,appID:this.appID,url:(null==this?void 0:this.url)||location.href,log:JSON.stringify(e),markUser:L(this.userID),markUv:M(),preUrl:document.referrer&&document.referrer!==location.href?document.referrer:""});return o&&(n.selector=o),n}},{key:"getExtendsInfo",value:function(){try{var t,e={},r=this.extendsInfo||{};for(var o in T(r.getDynamic)&&(t=r.getDynamic()),"Object"===P(t)&&(r=q(q({},r),t)),r)T(r[o])||(e[o]=r[o]);return e}catch(t){return{}}}}]),t}();function X(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}var K=function(){function t(e){o(this,t),i(this,"params",void 0),this.params=e}return n(t,[{key:"handleError",value:function(){new V(this.params)}}]),t}(),V=function(t){s(r,t);var e=X(r);function r(t){var n;return o(this,r),n=e.call(this,t),window.XMLHttpRequest&&n.handleXhrError(),window.fetch&&n.handleFetchError(),n}return n(r,[{key:"_handleEvent",value:function(t,e,r,o,n){try{var i,c=Date.now()-e;this.category=l.AJAX,this.msg=l.AJAX,this.errorObj={status:r.status,duration:c,type:t,method:n.method.toLowerCase(),lib:o,path:n.url,decodedBodySize:r.decodedBodySize||(null==r||null===(i=r.responseText)||void 0===i?void 0:i.length)||0},this.recordError()}catch(t){}}},{key:"handleXhrError",value:function(){var t=this,e=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,r){return r.match(/up.gif/)||r.match(/sockjs/)||(this.logData={method:t||h.GET,url:r}),e.apply(this,arguments)};var r=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){var e=this;if(this.addEventListener&&this.logData){var o=Date.now();["error","load","abort","onreadystatechange"].map((function(r){e.addEventListener(r,(function(){t._handleEvent(r,o,e,p.XHR,e.logData)}))}))}return r.apply(this,arguments)}}},{key:"handleFetchError",value:function(){var t=this,e=window.fetch;window.fetch=function(){for(var r,o={method:h.GET,url:""},n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];o.method=(null==i||null===(r=i[1])||void 0===r?void 0:r.method)||h.GET,o.url=i[0];var u=Date.now();e.apply(this,i).then(function(){var e=a(E.mark((function e(r){var n,i;return E.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.clone(),e.next=3,r.text();case 3:i=e.sent,t._handleEvent(r.ok?"load":"error",u,{status:n.status||r.ok?200:500,response:r,decodedBodySize:i.length},p.FETCH,o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw t._handleEvent("error",u,{status:500,response:e},p.FETCH,o),e}))}}}]),r}(G);function z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}var Y=function(t){s(r,t);var e=z(r);function r(t){return o(this,r),e.call(this,t)}return n(r,[{key:"handleError",value:function(){var t=this;window.onerror=function(e,r,o,n,i){try{t.category=l.JS,t.msg=e,t.url=r,t.line=o,t.col=n,t.errorObj=i,t.recordError()}catch(i){}}}}]),r}(G);function Z(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}var W=function(t){s(r,t);var e=Z(r);function r(t){return o(this,r),e.call(this,t)}return n(r,[{key:"handleError",value:function(){var t=this;window.addEventListener("unhandledrejection",(function(e){try{var r,o;if(!e||!e.reason)return;null!=e&&null!==(r=e.reason)&&void 0!==r&&null!==(o=r.config)&&void 0!==o&&o.url&&(t.url=e.reason.config.url),t.category=l.PROMISE,t.msg=e.reason,t.errorObj=e.reason,t.recordError()}catch(t){}}),!0)}}]),r}(G);function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}var rt=function(t){s(r,t);var e=et(r);function r(t){return o(this,r),e.call(this,t)}return n(r,[{key:"handleError",value:function(){var t=this;window.addEventListener("error",(function(e){try{if(!e)return;t.category=l.RESOURCE;var r=e.target||e.srcElement;if(!(r instanceof HTMLScriptElement||r instanceof HTMLLinkElement||r instanceof HTMLImageElement))return;t.msg="加载 ".concat(r.tagName," 资源错误"),t.url=location.href,t.errorObj=tt(tt({},r),{},{src:r.src||r.href}),t.recordError()}catch(t){}}),!0)}}]),r}(G);function ot(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}function nt(t,e,r,o){var n=null==o?void 0:o.version,i={message:"".concat(t.message,"(").concat(r,")"),url:"undefined"==typeof document||null===document.location?"":document.location.href,name:t.name,stack:t.stack||[]};if("String"===P(n))switch(function(t){return Number(t.split(".")[0])}(n)){case 2:i=Object.assign(i,function(t){var e="";if(t.$root===t)e="root";else{var r=t._isVue?t.$options&&t.$options.name||t.$options&&t.$options._componentTag:t.name;e=(r?"component <".concat(r,">"):"anonymous component")+(t._isVue&&t.$options&&t.$options.__file?" at ".concat(t.$options&&t.$options.__file):"")}return{componentName:e,propsData:t.$options&&t.$options.propsData}}(e));break;case 3:i=Object.assign(i,function(t){var e="";if(t.$root===t)e="root";else{var r=t.$options&&t.$options.name;e=r?"component <".concat(r,">"):"anonymous component"}return{componentName:e,propsData:t.$props}}(e));break;default:return}return i}var it=function(t){s(r,t);var e=ot(r);function r(t){return o(this,r),e.call(this,t)}return n(r,[{key:"handleError",value:function(t){var e=this;t&&(t.config.errorHandler=function(r,o,n){try{e.msg=JSON.stringify(nt(r,o,n,t)),e.category=l.VUE,e.recordError()}catch(r){}})}}]),r}(G),ct=function(){try{if(!window.performance||!window.performance.timing)return;var t=window.performance.timing,e={};return e.redirectTime=(t.redirectEnd-t.redirectStart).toFixed(2),e.dnsTime=(t.domainLookupEnd-t.domainLookupStart).toFixed(2),e.ttfbTime=(t.responseStart-t.navigationStart).toFixed(2),e.appcacheTime=(t.domainLookupStart-t.fetchStart).toFixed(2),e.unloadTime=(t.unloadEventEnd-t.unloadEventStart).toFixed(2),e.tcpTime=(t.connectEnd-t.connectStart).toFixed(2),e.reqTime=(t.responseEnd-t.responseStart).toFixed(2),e.analysisTime=(t.domComplete-t.domInteractive).toFixed(2),e.blankTime=(t.domLoading-t.navigationStart).toFixed(2),e.domReadyTime=(t.domContentLoadedEventEnd-t.navigationStart).toFixed(2),e.loadPageTime=(t.loadEventEnd-t.navigationStart).toFixed(2),e.radt=(t.fetchStart-t.navigationStart).toFixed(2)||0,e}catch(t){}},at=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0;if(window.performance&&window.performance.getEntries){var r=[],o=window.performance.getEntriesByType("resource");return o&&0!==o.length?(o.forEach((function(o){var n=o.name?o.name.split("?")[0]:"";n.indexOf(e)>-1||t.indexOf(o.initiatorType)>-1&&r.push({name:n,initiatorType:o.initiatorType,nextHopProtocol:o.nextHopProtocol,redirectTime:(o.redirectEnd-o.redirectStart).toFixed(2),dnsTime:(o.domainLookupEnd-o.domainLookupStart).toFixed(2),tcpTime:(o.connectEnd-o.connectStart).toFixed(2),ttfbTime:(o.responseStart-o.requestStart).toFixed(2),responseTime:(o.responseEnd-o.responseStart).toFixed(2),reqTotalTime:(o.responseEnd-o.requestStart).toFixed(2),decodedBodySize:o.decodedBodySize||0})})),r):r}};function ut(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function st(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ut(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ut(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,o=w(t);if(e){var n=w(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return g(this,r)}}var lt=function(t){s(r,t);var e=ft(r);function r(t){var n;return o(this,r),n=e.call(this,{reportUrl:t.reportUrl,appID:t.appID,userID:t.userID,extendsInfo:t.extendsInfo}),i(y(n),"isPage",void 0),i(y(n),"isResource",void 0),i(y(n),"usefulType",void 0),i(y(n),"outTime",void 0),i(y(n),"config",void 0),t.isPage=!1!==t.isPage,t.isResource=!1!==t.isResource,n.isPage=t.isPage,n.isResource=t.isResource,n.usefulType=n.getSourceType(t),n.outTime=50,n.config={resourceList:[],performance:{}},n.category=l.PERFORMANCE,n.reportUrl=t.reportUrl||"",n}return n(r,[{key:"getSourceType",value:function(t){var e=[];return!1!==t.isRScript&&e.push("script"),!1!==t.isRCSS&&e.push("css"),!1!==t.isRLink&&e.push("link"),!1!==t.isRIMG&&e.push("img"),e}},{key:"record",value:function(){try{this.isPage&&(this.config.performance=ct()||{}),this.isResource&&(this.config.resourceList=at(this.usefulType,this.reportUrl)||[]);var t={performance:this.config.performance,resourceList:this.config.resourceList},e=st(st({},this.getExtendsInfo()),{},{category:this.category,log:JSON.stringify(t),appID:this.appID,markUser:L(this.userID),markUv:M(),url:(null==this?void 0:this.url)||location.href});localStorage.setItem("page_performance",JSON.stringify(e)),new B(this.reportUrl).report(e),this.clearPerformance()}catch(t){}}},{key:"clearPerformance",value:function(){var t,e;null!==(t=window)&&void 0!==t&&null!==(e=t.performance)&&void 0!==e&&e.clearResourceTimings&&(performance.clearResourceTimings(),this.config.performance={},this.config.resourceList=[])}}]),r}(G),pt=function(){function t(){o(this,t),i(this,"jsError",void 0),i(this,"promiseError",void 0),i(this,"resourceError",void 0),i(this,"ajaxError",void 0),i(this,"vueError",void 0),this.jsError=!0,this.promiseError=!0,this.resourceError=!0,this.ajaxError=!0,this.vueError=!1}return n(t,[{key:"init",value:function(t){if(null==t||!t.reportUrl||!_(t.reportUrl))throw"reportUrl is error,".concat(t.reportUrl);if(null==t||!t.appID)throw"appID is error,".concat(t.appID);this.jsError=!(!1===(null==t?void 0:t.jsError)),this.promiseError=!(!1===(null==t?void 0:t.promiseError)),this.resourceError=!(!1===(null==t?void 0:t.resourceError)),this.ajaxError=!(!1===(null==t?void 0:t.ajaxError)),this.vueError=!0===(null==t?void 0:t.vueError);var e=t.reportUrl,r=t.appID,o={reportUrl:e,extendsInfo:t.extendsInfo||{},appID:r,userID:t.userID};this.jsError&&new Y(o).handleError(),this.promiseError&&new W(o).handleError(),this.resourceError&&new rt(o).handleError(),this.ajaxError&&new K(o).handleError(),this.vueError&&t.vue&&new it(o).handleError(t.vue),this.monitorPerformance(t);var n=function(){alert(1),sessionStorage.removeItem(d.FIRST_PV)};window.addEventListener("beforeunload",n),window.removeEventListener("beforeunload",n)}},{key:"monitorPerformance",value:function(t){window.onload=function(){setTimeout((function(){new lt(t).record()}),300)}}}]),t}();window.MonitorJS=pt,t.MonitorJS=pt,Object.defineProperty(t,"__esModule",{value:!0})}));
